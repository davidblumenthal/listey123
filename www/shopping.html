<!DOCTYPE html>
<html>
<head>
  <title>Listey</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="js/jq/jquery.mobile-1.3.1.min.css" />
  <script type="text/javascript" src="js/jq/jquery-1.9.1.min.js"></script>
  <script type="text/javascript" src="js/jq/jquery.mobile-1.3.1.min.js"></script>
</head>
<body>

<!-- ************************************************************************ -->
<div data-role="page" id="choose-list-page">
  <div data-role="header">
    <h1>Choose a list</h1>
  </div><!-- header -->

    <div data-role="content">
    	<a href="#add-list-dialog" data-role="button" data-rel="dialog">Add A List</a>
        <ul data-role="listview" data-count-theme="c" data-inset="true">
                <li><a href="#list-page">Shopping<span class="ui-li-count">12</span></a></li>
        </ul>
  </div><!-- content -->
</div><!-- choose-list -->


<!-- ************************************************************************ -->


<div data-role="page" id="list-page">
  <div data-role="header">
    <h1>Shopping</h1>
    <a href="#choose-list-page" data-role="button" data-icon="home">Home</a>
  </div><!-- header -->
    <div data-role="content">
    	<a href="#config-item-dialog" data-role="button" data-rel="dialog">Add An Item</a>

        <ul data-role="listview" data-filter="true" data-split-icon="gear" data-count-theme="b" data-inset="true">
                <li>
                	<a href="#">Milk</a>
                	<span class="ui-li-count">2</span>
                	<a href="#config-item-dialog" data-rel="dialog">Configure</a>
                </li>
                <li>
                	<a href="#" data-rel="dialog">Pepper</a>
                	<a href="#config-item-dialog" data-rel="dialog">Configure</a>
                </li>
                <li data-role="list-divider">Crossed off</li>
                <li>
				  	<a href="#" data-rel="dialog"><strike>Salt</strike></a>
				    <a href="#config-item-dialog" data-rel="dialog">Configure</a>
                </li>
        </ul>

    	<a href="#config-cat-dialog" data-role="button" data-rel="dialog">Configure Categories</a>
  </div><!-- content -->
</div><!-- list-page -->

<!-- ************************************************************************ -->


<div data-role="page" id="config-item-dialog">
    <div data-role="header">
      <h1>Item Details</h1>
      <a href="#list-page" data-role="button" data-icon="back">Save</a>
    </div><!-- header -->
    <div data-role="content">
        <input type="text" name="item_name"  data-inline="true" placeholder="Item name">Count: 1
        <a href="#" data-role="button" data-inline="true">More</A>
        <a href="#" data-role="button" data-inline="true">Less</A>&nbsp;&nbsp;&nbsp;
        <a href="#" data-role="button" data-inline="true">Delete</A><br>
        <div  data-role="fieldcontain">
            <fieldset data-role="controlgroup">
                <legend>Choose which categories this applies to:</legend>
                <input type="checkbox" name="checkbox-1a" id="checkbox-1a" class="custom" />
                <label for="checkbox-1a">Central Market</label>
                <input type="checkbox" name="checkbox-1b" id="checkbox-1b" class="custom" />
                <label for="checkbox-1b">Breed & Co</label>
          </fieldset>
      </div>
      <a href="#config-cat-dialog" data-role="button" data-rel="dialog">Configure Categories</a>
    </div><!-- content -->
</div><!-- config-item-dialog -->

<!-- ************************************************************************ -->

<div data-role="page" id="config-cat-dialog">
    <div data-role="header">
      <h1>Configure Category</h1>
      <a href="#list-page" data-role="button" data-icon="back">Save</a>
    </div><!-- header -->
    <div data-role="content">
        <input type="text" name="catName"  placeholder="Category name">
    </div><!-- content -->
</div><!-- config-cat-dialog -->

<!-- ************************************************************************ -->

<div data-role="page" id="add-list-dialog">
    <div data-role="header">
      <h1>Add List</h1>
      <a href="#list-page" data-role="button" data-icon="back">Save</a>
    </div><!-- header -->
    <div data-role="content">
        <input type="text" name="listName"  placeholder="List name">
    </div><!-- content -->
</div><!-- add-list-dialog -->


<!-- ************************************************************************ -->

<script>
<!--
  Data format:
    listName => {items : [{name : "Butter",
  	                       count: 2,
  	                       state: "crossedOff",
  	                       lastUpdate: "06/28/2013 13:25:29 CDT",
  	                      },
  	                      {name : "Milk",
  	                       lastUpdate: "06/28/2013 13:25:29 CDT",
  	                      },
  	                      {name : "Eggs",
  	                       state: "deleted",
  	                       lastUpdate: "06/28/2013 13:25:29 CDT",
  	                      },
  	                      {name : "Doritos",
  	                       state: "purged",
  	                       lastUpdate: "06/28/2013 13:25:29 CDT",
  	                      },
  	                      ],
  	              }

-->



function save() {
	var keyId="lang1", valId = "lang2";
	console.log("save clicked");
	var k = document.getElementById(keyId).value;
	var v = document.getElementById(valId).value;
	var data = get_data('lists');
	data[k] = v;
	localStorage.setItem('store', JSON.stringify(data));
	display('Saved ' + k +  ' ' + v);

	document.getElementById(keyId).value = '';
	document.getElementById(valId).value = '';

	list();

	return false;
}

function display(html,divId) {
	if (!divId) {
		divId = 'response';
	}
	document.getElementById(divId).innerHTML = html;
}

function list() {
	var data = get_data('lists');
	var has_keys=0;
	for (var k in data) {has_keys++; break}

	if (has_keys) {
		var html = '<b>Listing:</b><br>';
		for (k in data){
			html += k + ' = ' + data[k] + '<br>';
		}
		display(html, 'list');
		return false;
	}
	display ('Empty', 'list');
	return false;
}
function get_data(field) {
	var data_str = localStorage.getItem(field);
	if (data_str == null) {
		return {};
	}
	return JSON.parse(data_str);
}
//document.getElementById('save').addEventListener('click', save);

//list();
</script>
</body>
</html>